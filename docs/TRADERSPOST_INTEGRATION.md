# TradersPost Integration Guide (v6.1.3)

## Overview

This guide documents the automated trading integration for TradersPost. Ideally suited for:
**TradingView Strategy/Indicator -> Webhook -> TradersPost -> Broker (IBKR)**.

## 1. Script Configuration

### Strategy: `SkippALGO_Strategy.pine`

The strategy now automatically generates **JSON Payloads** in the `alert_message` field of every order.

* **Payload Format**:

    ```json
    {
      "ticker": "AAPL",
      "action": "buy",
      "orderId": "L",
      "uniqueId": "AAPL-15-1697234500000-L",
      "price": 150.45,
      "contracts": 100,
      "sentiment": "bullish"
    }
    ```

* **Unique ID**: `{{ticker}}-{{interval}}-{{time}}-{{orderId}}`. Used for idempotency (deduplication) on the execution side.

### Indicator: `SkippALGO.pine` (Alerts)

New inputs have been added under the **Automation** group:

* **Enable JSON Webhook Payloads**: Check this to output JSON instead of plain text.
* **Reference ID**: Optional tag (e.g., `Strategy_A`) included in the payload.

## 2. TradingView Setup

### Webhook URL

Point your TradingView Alert verification to your TradersPost webhook URL:
`https://api.traderspost.io/webhook/your-token-id`

### Alert Message

**For Strategy:**
in the "Message" field of the Create Alert dialog, USE EXACTLY:

```text
{{strategy.order.alert_message}}
```

*TradingView will replace this placeholder with the JSON generated by the script.*

**For Indicator:**

1. Enable "Enable JSON Payloads" in settings.
2. Select "Any Function Call" (or specific condition like "Any Alert Function Call").
3. The script will send the JSON string explicitly via the `alert()` function.

## 3. Implementation Reality Check (Best Practices)

1. **Bar Close Only**: The scripts use `barstate.isconfirmed` for all execution logic. This prevents intra-bar "repainting" or signal flipping.
2. **Idempotency**: The `uniqueId` field in the payload allows TradersPost to ignore duplicate signals if TradingView misfires or sends retries.
3. **Source of Truth**:
    * **IBKR/Broker** is the master.
    * Ensure your TradersPost "Symbol Settings" are configured to align with the strategy's sizing.
4. **Grace Period**: The Strategy includes an `Exit Grace Period` (default 5 bars) to prevent noise exits, but `ChoCH` structural failures trigger an **immediate** fail-safe exit.

## 4. Verification

1. Add Strategy to Chart.
2. Open Data Window.
3. Look for "SkippALGO BUY".
4. (In Backtest) Hover over the blue arrow on the chart.
5. (Live) Create a test alert using `{{strategy.order.alert_message}}` and verify with a webhook tester (e.g., webhook.site) before connecting to live capital.
